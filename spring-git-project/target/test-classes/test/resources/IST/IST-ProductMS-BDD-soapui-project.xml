<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="28c527be-9fc3-49b8-849b-3676b2e08ef9" activeEnvironment="Default" name="IST- ProductMS-BDD" soapui-version="5.3.0" abortOnError="false" runType="SEQUENTIAL" resourceRoot="${projectDir}" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="89980d8e-36dc-4463-af8c-bc4c18aa0785" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8080" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:endpoint>http://localhost:8080</con:endpoint></con:endpoints><con:resource name="Products" path="/sampleproductmscamel/service/products" id="f39a5f62-8d1a-411a-9b6c-fbb4c4895df5"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value>1</con:value><con:style>QUERY</con:style><con:default>1</con:default><con:path xsi:nil="true"/><con:description xsi:nil="true"/></con:parameter><con:parameter><con:name>customerType</con:name><con:value>1</con:value><con:style>QUERY</con:style><con:default>1</con:default><con:path xsi:nil="true"/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Method 1" id="1266af56-b5f9-4af1-bd67-e1c299f03053" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:prod="http://localhost/sampleproductms/service/products">prod:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="de36c683-4a25-4001-872b-7044752a8ec9" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request/><con:originalUri>http://localhost/sampleproductms/service/products</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="id" value="${#TestCase#id}"/>
  <con:entry key="customerType" value="${#TestCase#customerType}"/>
</con:parameters><con:parameterOrder><con:entry>id</con:entry><con:entry>customerType</con:entry></con:parameterOrder></con:request></con:method></con:resource><con:resource name="createProduct" path="/sampleproductmscamel/service/createProduct" id="cbe9916e-e3d8-49aa-b4b2-9d481e229da8"><con:settings/><con:parameters/><con:method name="Method 1" id="8f2ecf8e-7882-43e8-b192-b76498b124cc" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400</con:status><con:params/><con:element>Fault</con:element></con:representation><con:request name="Request 1" id="c8aaf793-d494-49f2-a977-80254457d564" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request>{
   "id": 1,
   "productName": "ProductX",
   "description": "Product1",
   "mfgdate": "10/10/2006",
   "sku": "abcd1",
   "amount": 0
}</con:request><con:originalUri>http://localhost/sampleproductms/service/createProduct</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="products" path="/sampleproductmscamel/service/products" id="f7eaea38-1b43-409f-9b99-3fe4eba3d3e1"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value>1</con:value><con:style>QUERY</con:style><con:default>1</con:default></con:parameter><con:parameter><con:name>customerType</con:name><con:value>1</con:value><con:style>QUERY</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Method 1" id="8add1098-7c47-41cb-8fbb-a2fbba319238" method="GET"><con:settings/><con:parameters/><con:request name="Request 1" id="70fd2c1f-d893-429d-85ea-31adc41b9cd0" mediaType="application/json"><con:settings/><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="id" value="${Property - Looper#id}"/>
  <con:entry key="customerType" value="${Property - Looper#customerType}"/>
</con:parameters></con:request></con:method></con:resource></con:interface><con:testSuite id="89155d7e-1605-455b-b887-592363eba056" name="TestSuite-GetProduct"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="a63b8af9-5918-469a-bd6f-8099702456ad" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase-ExistingProd- CustomerType 1" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="RequestForCustType1" id="f0469237-c0a2-4e5a-ba2e-7bc20f16c7cb"><con:settings/><con:config service="http://localhost:8080" methodName="Method 1" resourcePath="/sampleproductmscamel/service/products" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RequestForCustType1" id="01050b8b-c849-4433-9695-ab995cf146f1" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request/><con:originalUri>http://localhost/sampleproductms/service/products</con:originalUri><con:assertion type="Simple Contains" id="0cd2b8d2-9666-41ee-82b8-4f07c0dd290b" name="Contains"><con:configuration><token>2006/10/10</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="id" value="${#TestCase#id}"/>
  <con:entry key="customerType" value="${#TestCase#customerType}"/>
</con:parameters></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>id</con:name><con:value>0</con:value></con:property><con:property><con:name>customerType</con:name><con:value>0</con:value></con:property></con:properties></con:testCase><con:testCase id="1675ba32-1493-422a-892e-e6ccf1df9e94" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase-ExistingProd- CustomerType 2" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="RequestForCustType2" id="f0c811f9-75f5-46b5-8e0b-629831e98607"><con:settings/><con:config service="http://localhost:8080" resourcePath="/sampleproductmscamel/service/products" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RequestForCustType2" id="de36c683-4a25-4001-872b-7044752a8ec9" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request/><con:originalUri>http://localhost/sampleproductms/service/products</con:originalUri><con:assertion type="Simple Contains" id="c40be2fa-fc43-4831-bd5b-ac5c08406670" name="Contains"><con:configuration><token>10/10/06</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="id" value="${#TestCase#id}"/>
  <con:entry key="customerType" value="${#TestCase#customerType}"/>
</con:parameters><con:parameterOrder><con:entry>id</con:entry><con:entry>customerType</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>id</con:name><con:value>1</con:value></con:property><con:property><con:name>customerType</con:name><con:value>1</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite id="267004c4-5e18-446a-aafd-5bfb298731aa" name="TestSuite-CreateProduct"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="827f6c26-2024-4b0b-be6d-6f96f133475e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase -MissingDataInWareHouse" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="RequestForMissingDataInWareHouse" id="bb3118bb-b7b0-456f-b3ee-61b10d76b194"><con:settings/><con:config service="http://localhost:8080" resourcePath="/sampleproductmscamel/service/createProduct" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RequestForMissingDataInWareHouse" id="c8aaf793-d494-49f2-a977-80254457d564" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request>{
   "id": ${#TestCase#id},
   "productName": ${#TestCase#productName},
   "description": ${#TestCase#description},
   "mfgdate": ${#TestCase#mfgdate},
   "sku": ${#TestCase#sku},
   "amount": ${#TestCase#amount}
}</con:request><con:originalUri>http://localhost/sampleproductms/service/createProduct</con:originalUri><con:assertion type="Simple Contains" id="37cb8de2-9e40-40ea-a8fd-9dbb112f262c" name="Contains"><con:configuration><token>false</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>id</con:name><con:value>0</con:value></con:property><con:property><con:name>productName</con:name><con:value>ProductX</con:value></con:property><con:property><con:name>description</con:name><con:value>sample desc</con:value></con:property><con:property><con:name>mfgdate</con:name><con:value>10/10/2006</con:value></con:property><con:property><con:name>sku</con:name><con:value>abcd1</con:value></con:property><con:property><con:name>amount</con:name><con:value>0</con:value></con:property></con:properties></con:testCase><con:testCase id="8c70ea05-665a-4b40-b82b-81bb0b90c274" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase - MissingBarCode" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="RequestForMissingBarCode" id="b9e0be94-7824-485e-9067-79a7d710301d"><con:settings/><con:config service="http://localhost:8080" resourcePath="/sampleproductmscamel/service/createProduct" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RequestForMissingBarCode" id="c8aaf793-d494-49f2-a977-80254457d564" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request>{
   "id": ${#TestCase#id},
   "productName": ${#TestCase#productName},
   "description": ${#TestCase#description},
   "mfgdate": ${#TestCase#mfgdate},
   "sku": ${#TestCase#sku},
   "amount": ${#TestCase#amount}
}</con:request><con:originalUri>http://localhost/sampleproductms/service/createProduct</con:originalUri><con:assertion type="Simple Contains" id="0cb3f77f-36b9-4e27-89ce-9f9f05e24556" name="Contains"><con:configuration><token>false</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>id</con:name><con:value>0</con:value></con:property><con:property><con:name>productName</con:name><con:value>sample</con:value></con:property><con:property><con:name>description</con:name><con:value>sample</con:value></con:property><con:property><con:name>mfgdate</con:name><con:value>2007/10/10</con:value></con:property><con:property><con:name>sku</con:name><con:value>0</con:value></con:property><con:property><con:name>amount</con:name><con:value>10</con:value></con:property></con:properties></con:testCase><con:testCase id="e1f35c0c-a45b-4a8a-862c-39adddf27872" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase-ValidProduct" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="RequestForValidProduct" id="a3e1013d-9d0e-413f-b877-92e114534ae7"><con:settings/><con:config service="http://localhost:8080" resourcePath="/sampleproductmscamel/service/createProduct" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="RequestForValidProduct" id="c8aaf793-d494-49f2-a977-80254457d564" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request>{
   "id": ${#TestCase#id},
   "productName": ${#TestCase#productName},
   "description": ${#TestCase#description},
   "mfgdate": ${#TestCase#mfgdate},
   "sku": ${#TestCase#sku},
   "amount": ${#TestCase#amount}
}</con:request><con:originalUri>http://localhost/sampleproductms/service/createProduct</con:originalUri><con:assertion type="Simple Contains" id="9168a286-4169-4263-9e70-a0cb3774e869" name="Contains"><con:configuration><token>true</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>id</con:name><con:value>1</con:value></con:property><con:property><con:name>productName</con:name><con:value>sample</con:value></con:property><con:property><con:name>description</con:name><con:value>sample</con:value></con:property><con:property><con:name>mfgdate</con:name><con:value>2007/10/11</con:value></con:property><con:property><con:name>sku</con:name><con:value>1</con:value></con:property><con:property><con:name>amount</con:name><con:value>1000</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite id="7bc32ef2-bdf0-445e-870b-8433e90f00df" name="GetProduuct-DataDriven"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="f1ce4e59-c87f-4de0-9fde-d70e0aeb0ad8" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetProductDataDriven" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="Method 1 - Request 1" id="e7cfffff-d714-4abc-ab2b-ba941cbd7528"><con:settings/><con:config service="http://localhost:8080" resourcePath="/sampleproductmscamel/service/products" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Method 1 - Request 1" id="70fd2c1f-d893-429d-85ea-31adc41b9cd0" mediaType="application/json"><con:settings/><con:endpoint>http://${#Project#ServiceEndPoint}</con:endpoint><con:request/><con:originalUri>http://localhost/sampleproductmscamel/service/products</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters>
  <con:entry key="id" value="${Property - Looper#id}"/>
  <con:entry key="customerType" value="${Property - Looper#customerType}"/>
</con:parameters></con:restRequest></con:config></con:testStep><con:testStep type="properties" name="Property - Looper" id="9d0569da-1756-402f-86ea-44a0e3791ccd"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>id</con:name><con:value>1</con:value></con:property><con:property><con:name>customerType</con:name><con:value>2</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="data driver" id="5600c8a5-2684-4def-8286-424e6e354883"><con:settings/><con:config><script>import jxl.* 
import groovy.json.JsonSlurper

def myTestCase = context.testCase 
propTestStep = myTestCase.getTestStepByName("Property - Looper")

def inputFile = testRunner.testCase.testSuite.project.getPropertyValue( "inputFile" )
log.info("inputFile " +inputFile)
def f = new File(inputFile.toString())

def wk = Workbook.getWorkbook(f) 
def s1 = wk.getSheet(0)
def rows = s1.getRows() 
log.info("rows " +rows)

for(def i=1;i&lt;rows;i++)
{
 	def c1 = s1.getCell(0, i) 
 	def c2 = s1.getCell(1, i)
 	log.info("id " +c1.getContents())
 	log.info("customerType " +c2.getContents())
	
 	propTestStep.setPropertyValue("id",c1.getContents())
 	propTestStep.setPropertyValue("customerType",c2.getContents())
	
 	def res = testRunner.runTestStepByName("Method 1 - Request 1")
 	log.info("Processing Response")
 	def response = res.getResponse()
     def jsonStr = response.getContentAsString()
     log.info(jsonStr)
     JsonSlurper ser = new JsonSlurper()
     def obj = ser.parseText(jsonStr)
	
	def custType = c2.getContents()
	log.info("customerType:"+custType)
	def dateFieldValue = obj.mfgdate
	log.info("date:"+dateFieldValue)
	if(custType.equals('1')){
		boolean match = dateFieldValue ==~ /\d{4}\/\d{2}\/\d{2}/
		log.info("Date format matches:"+match)
		assert match == true
	}else{
		boolean match = dateFieldValue ==~ /\d{2}\/\d{2}\/\d{2}/
		log.info("Date format matches:"+match)
		assert match == true
	}
}</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>ServiceEndPoint</con:name><con:value>localhost:8080</con:value></con:property><con:property><con:name>inputFile</con:name><con:value>src/test/resources/DATA.xls</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>